{% extends "store/base.html" %}
{% block navbar %}
{% include "store/navbar.html"%}
{% endblock %}
{% block content %}
<div class="post form">
    <div class='row', id='inv-h'>
        <div class="col-md-8">
            {% if SingleItem.id %}
            <h2>Update product: {{ SingleItem.inventory_text }}</h2>
            {% else %}
            <h2>Create a new product</h2>
            {% endif %}
        </div>

    </div>
    <hr/>
    <div class='row'>
    <form method="POST" action="" class="post-form form-vertical">
        {% csrf_token %}
        {% if SingleItem.id %}
        <div class='col-md-6'>
            <table>
                {{ Item_form.as_table }} 
            </table>
        </div>
        {% else %}
        <div>
            <table>
            {{formset.as_table}}
            </table>
        </div>
        {% endif %}
    <div class='text-right', id='inventory-buttons'>
        <button class="save btn btn-primary pull-right" type="submit" value="Submit">Submit</button>
        {% if SingleItem.id %}
        <a href="{% url 'single_item' SingleItem.id %}" class="btn btn-default pull-right">Cancel</a>
        {% else %}
        <a href="/inventory" class="btn btn-default pull-right">Cancel</a>
        {% endif %}
    </div>
    </form>    
    </div>
</div>
{% endblock %}

    {% comment %} {% load formset_tags %}

    {% for hidden in Item_form.hidden_fields %}
    {{ hidden }}
    {% endfor %}

    {% if Item_form.non_field_errors %}
    <div class="row">
        <div class="col-xs-12 alert alert-danger">
            {{ Item_form.non_field_errors }}
        </div>
    </div>
    {% endif %} 

<!--errors!>
    <div class="row">
        <div class="form-group {% if item_form.name.errors %}has-error{% endif %}">
            <div class="col-xs-2 text-right">
                <label class="control-label" for="{{item_form.name.id_for_label}}">Item Name:</label>
            </div>
            <div class="col-xs-3">{{item_form.name}}</div>
            <div class="col-xs-4">
                <span class="help-block">{{item_form.name.errors}}</span>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="checkbox {% if item_form.active.errors %}has-error{% endif %}">
            <div class="col-xs-2 text-right">
                <label class="control-label" for="{{item_form.active.id_for_label}}">Active:</label>
            </div>
            <div class="col-xs-3">{{item_form.active}}</div>
            <div class="col-xs-4">
                <span class="help-block">{{item_form.active.errors}}</span>
            </div>
        </div>
    </div>
<!-->

    <hr/>

    {{ Item_form.management_form }}
    <div class="row">
        <div class="col-xs-12">
            <table id="item_line_table" class="table">
                <thead>
                    <tr>
                        <th>Product</th>
                        <th>Media Type</th>
                        <th>Cost</th>
                        <th>Container</th>
                        <th>Volume</th>
                        <th>Notes</th>
                        <th>Delete</th>
                    </tr>
                </thead> 
                <tbody>
                    {% for item in Item_form%}
                    <tr>
                        {% for hidden in form.hidden_fields %}
                            {{hidden}}
                        {% endfor %}
                        <tr>
                        <td>{{Item_form}}</td>
                    </tr>
                    {% if form.errors %}
                    <tr>
                        {% for field in form.visible_fields %}
                        <td>{{field.errors}}</td>
                        {% endfor %}
                    </tr>
                    {% endif %}
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <div class="row">
        <div class="col-xs-12">
            <input id="add_item_line" class="btn btn-default" type="button" value="Add another line" />
        </div>
    </div>
    <hr/>
    <div class="row">
        <div class="col-xs-12">
            <input class="btn btn-primary" type="submit" value="Submit" name="workorder_submit"/>
            {% if item.instance.id %}
            <a href="#" class="btn btn-default">Cancel</a>
            {% else %}
            <a href="#" class="btn btn-default">Cancel</a>
            {% endif %}
        </div>
    </div>
</form>
{% verbatim %}
<script id="item-line-form" type="text/x-handlebars-template">
    <tr>
        <input id="id_SingleItem_set-{{id}}-id" name="SingleItem_set-{{id}}-id" type="hidden">
        <td><input id="id_SingleItem_set-{{id}}-SingleItem_text" maxlength="100" name="SingleItem_set-{{id}}-SingleItem_text" type="text"></td>
        <td>

<select id="id_SingleItem_set-{{id}}-media_type" class="chosen-select line-media_type" name="SingleItem_set-{{id}}-media">
        {% endverbatim %}
        <option value="">------</option>
        {% for option in Item_form.forms.0.instance.MEDIA_CHOICES %}
        <option value="{{option.0}}">{{option.1}}</option>
        {% endfor %} 
        {% verbatim %}
    </select>
        </td>
        <td><input class="line_cost" id="id_SingleItem_set-{{id}}-cost" maxlength="5" name="SingleItem_set-{{id}}-cost" type="text"></td>
        <td><input class="line-container" id="id_SingleItem_set-{{id}}-container" maxlength="30" name="SingleItem_set-{{id}}-container" type="text"></td>
        <td><input class="line-volume" id="id_SingleItem_set-{{id}}-volume" maxlength="30" name="SingleItem_set-{{id}}-volume" type="text"></td>
        <td><input class="line-notes" id="id_SingleItem_set-{{id}}-notes" maxlength="500" name="SingleItem_set-{{id}}-notes" type="text"></td>
        <td><input id="id_SingleItem_set-{{id}}-DELETE" name="SingleItem_set-{{id}}-DELETE" type="checkbox"></td>
    </tr>
</script>
{% endverbatim %} {% endcomment %}
