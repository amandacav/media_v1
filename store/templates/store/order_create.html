{% extends "store/base.html" %}
{% block navbar %}
{% include "store/navbar.html"%}
{% endblock %}
{% block content %}
{% load formset_tags %}
{% load store_tags %}

<div class="row">
    <div class="col-xs-12">
        {% if order_form.instance.id %}
        <h3>Editing order : {{order_form.instance.id}}</h3>
        {% elif copy_id %}
        <h3>Create a new order based on {{copy_id}}</h3>
        {% else %}
        <h3>Create a new order</h3>
        {% endif %}
    </div>
</div>

{% if not copy_id and order_form.instance.date_billed %}
<div class="row">
  <div class="col-xs-offset-2 col-xs-8 alert alert-danger text-center">
    <b>This order has already been billed. No changes will be saved!</b>
    <p> Please contact the Media Store administrator if you believe changes need to be made.</p>
  </div>
</div>
{% endif %}

<hr/>

<!--{{ form.non_field_errors }}-->

<form method="post" action="" id="order_form-h" class="form-horizontal">
    {% csrf_token %}
    {% for hidden in order_form.hidden_fields %}
    {{ hidden }}
    {% endfor %}

    <fieldset>
        <legend>Who is creating this Order?</legend>
    </fieldset>


    <fieldset>
        <legend>Who is paying?</legend>
    </fieldset>

    <fieldset>
        <legend>Is this a Recurring Order?</legend>
        <section id='first' class = 'section'>
            <div class = 'container'>
                <input type="radio" name="group1" id='radio_1'>
                <label for = 'radio_1'><span class="radio">Yes</span></label>
            </div>
            <div class="container">
                <input type="radio" name="group1" id="radio_2">
                <label for = 'radio_2'><span class="='radio">No</span></label>
            </div>
        </section>
    </fieldset>

    <fieldset>
        <legend>What would you like to order?</legend>
        {% if radio_1 %}
            <div class="row">
                <div class="form-group {% if order_form.inventory.errors %}has-error{% endif %}">
                    <div class="col-xs-2 text-right">
                        <label class="control-label" for="{{order_form.inventory.id_for_label}}">Item:</label>
                    </div>
                </div>
            </div>

            {{ line_formset.management_form }}
            <div class='row'>
                <div class="col-xs-12">
                    <table id='order_create' class="table">
                    <thead>
                        <tr>
                            <th>Item</th>
                            <th>Container</th>
                            <th>Notes</th>
                            <th>Qty</th>
                            <th>Unit</th>
                            <th>Cost</th>
                            <th>Delete?<input type="checkbox" class="delete-all" /></th>
                            <th>Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in line_formset %} <!--item or form in order_form-->
                        <tr>
                            {% for hidden in form.hidden_fields %}
                            {{hidden}}
                            {% endfor %}
                            {% for field in form.visible_fields %}
                        <td>
                        {{line_formset}}
                        </td>
                        <td class='line_total'>
                        {{form.instance.total | currency}}</td>
                        </tr>
                        {% if form.errors %}
                        <tr>
                            {% for field in form.visible_fields %}
                            <td>{{field.errors}}</td>
                            {% endfor %}
                        </tr>
                        {% endif %}
                        {% endfor %}
                    </tbody>
                    </table>
                </div>
            </div>

            <div class='row'>
                <div class='col-xs-3'>
                    <input type="add_order_line" class='btn-default' type='button' value="Add another order line" />
                </div>
                <div class="col-xs-offset-7 col-xs-2 text-right">
                    <p class="aggregate_total">{{line_formset.instance.total | currency}}</p>
                </div>
            </div>
        {% endfor %}
            <div class ='row'>
                <p>This is a test.</p>
            </div>
        {% endif %}
    </fieldset>










<!--                <div class="col-xs-3">
                    <select id='inventory_id' name='inventory' class="chosen-select" style="display: none;"></select>

                <div class="col-xs-3">{{order_form.inventory}}</div>
                <div class="col-xs-4">
                    <span class="help-block">{{order_form.inventory.errors}}</span>
                </div>
            </div>
        </div>
        <hr/>
        <div class="row">
            <div class="col-xs-12">
                <table id='form_holder'>
                    <tr>
                        <td style="padding:0" class="order_lines">
                            {{ line_formset.management_form }}
                            {{ line_formset.media }}
                            <table id="order_table">

                            <tbody>
                                {% for form in line_formset %}
                                <tr>
                                {% for hidden in form.hidden_fields %}
                                    {{hidden}}
                                {% endfor %}
                                {% for field in form.visible_fields %}
                                <td>{% if field.name == 'cost' %}${% endif %}{{field}}</td>
                                {% endfor %}
                                </tr>
                                {% if form.errors %}
                                <tr>
                                    {% for field in form.visible_fields %}
                                    <td>{{field.errors}}</td>
                                    {% endfor %}
                                </tr>
                                {% endif %}
                                {% endfor %}
                            </tbody>
                            </table>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-3">
            <tr>
                <td><input id="add_order_line" class="btn btn-default" type="button" value="Add another service" /></td>
                <td><input id='clear_all' class="btn clear" type='button' value="Delete All"></td>
            </tr>
        </div>
        <hr/>-->

{% endblock %}

