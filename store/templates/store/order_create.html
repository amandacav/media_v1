{% extends "store/base.html" %}
{% block navbar %}
{% include "store/navbar.html"%}
{% endblock %}
{% block content %}
{% load formset_tags %}
{% load store_tags %}

<hr/>
<p>&nbsp;</p>

<div class='row'>
    <div class='col-xs-12'>
    <h2>Create a new order</h2>
    </div>
</div>
<hr/>
<p>&nbsp;</p>



<form id='order_form' method="post" action="" class="post-form form-horizontal">
    {% csrf_token %}
    {% for hidden in form.hidden_fields %}
        {{ hidden }}
    {% endfor %}

    {% for field in form.visible_fields %}
        {{ field.errors }}
        {{ field.help_text }}
        {{ field }}
    {% endfor %}
    <fieldset>
        <legend>Who is creating this order?</legend>
    </fieldset>
    <p>&nbsp;</p>

    <fieldset>
        <legend>Who is paying?</legend>
    <p>&nbsp;</p>
    </fieldset>


    <fieldset>
        <legend>Is this a recurring order?</legend>
        <section id='first' class = 'section'>
            <div class = 'container'>
                <input type="radio" name="group1" id='radio_1'>
                <label for = 'radio_1'><span class="radio">Yes</span></label>
            </div>
            <div class="container">
                <input type="radio" name="group1" id="radio_2">
                <label for = 'radio_2'><span class="='radio">No</span></label>
            </div>
        </section>
    </fieldset>
    <p>&nbsp;</p>

    <fieldset>
        <legend>What would you like to order?</legend>
            <div class='col-xs-12'>
                <table id='form_holder'>
                    <tr>
                        <td style="padding:0" class="OrderLines">
                            {{ formset.management_form }}
                            {{ formset.media }}
                            <table id='order_table'>
                            <thead>
                                <th>Media Type</th>
                                <th>Item</th>
                                <th>Container</th>
                                <th>Notes</th>
                                <th>Qty</th>
                                <th>Unit</th>
                                <th>Cost</th>
                                <th>Delete?<input type='checkbox' class='delete-all' /></th>
                                <th>Total</th>
                            </thead>
                            <tbody>
                                {% for form in formset %}
                                <tr>
                                {% for hidden in form.hidden_fields %}
                                    {{ hidden }}
                                {% endfor %}

                                {% for field in form.visible_fields %}
                                <td>{% if field.name == 'cost' %}${% endif %}{{field}}</td>
                                {% endfor %}

                                <td class='total'>
                                {{form.instance.total | currency}}</td>
                                </tr>
                                {% if form.errors %}
                                <tr>
                                {% for field in form.visible_fields %}
                                    <td>{{field.errors}}</td>
                                    {% endfor %}
                                </tr>
                                {% endif %}
                                {% endfor %}
                            </tbody>
                            </table>
                        </td>
                    </tr>
                </table>
            </div>
            import ipdb; ipdb.set_trace()

            <div class='row'>
                <div class = 'col-xs-3'>
                    <input id='add_order_line' class='btn btn-default' type='button' value="Add Item" />
                </div>
                <div class='col-xs-offset-7 col-xs-2 text-right'>
                    <p class="aggregate_total">
                    {{order_form.instance.total | currency}}</p>
                </div>
            </div>
        </fieldset>
            <div class='row'>
                <hr/>
                <p></p>
                <div class='col-xs-11'>
                    <input class='btn btn-default' type='submit' value='Complete Order' name='submit'>
                </div>
                <div class="col-xs-1">
                    <a href='/' class="btn btn-danger">Cancel</a>
                </div>
            </div>
</form>

<p>&nbsp;</p>
s

{% verbatim %}s
<script id='order-line-form' type='text/x-handlebars-template'>
    <tr class='highlight'>
        <input id='id_orderlines-{{id}}-id' name='orderlines-{{id}}-id' type='hidden'>
        <input id='id_orderlines-{{id}}-order' name='orderlines-{{id}}-order' type='hidden'>

        <td>
            <select id = 'id_orderlines-{{id}}-media_type' class='chosen-select line-media_type' name = 'orderlines-{{id}}-media_type'>
            {% endverbatim %}
            <option value=''>-----------</option>
            {% for option in line_formset.forms.0.instance.media_type %}
            <option value='{{option.0}}'>{{option.1}}</option>
            {% endfor %}
            {% verbatim %}
            </select>
        </td>
        <td><input class='line-container' id='id_orderlines-{{id}}-container' name='orderlines-{{id}}-containier' type ='text' value='{{container}}'></td>
        <td><textarea cols='40' id='id_orderlines-{{id}}-description' name='orderlines-{{id}}-notes' rows='10'></textarea>}
        {{description}}</td>
        <td><input class="line_calc line_qty" id='id_orderlines-{{id}}-qty' name='orderlines-{{id}}-qty' step='any' type='number' value='{{qty}}'></td>
        <td><input class='line-unit' id='id_orderlines-{{id}}-unit' maxlength='30' name='orderlines-{{id}}-unit' type='text' value='{{unit}}'></td>
        <td><input class="line_calc line_cost" id='id_orderlines-{{id}}-cost' name='orderlines-{{id}}-cost' step='any' type='number' value='{{cost}}'></td>
        <td><input id='id_orderlines-{{id}}-DELETE' name='orderlines-{{id}}-DELETE' type='checkbox'></td>
        <td class='line_total'>$0.00</td>

    </tr>
</script>
{% endverbatim %}
{% endblock %}

